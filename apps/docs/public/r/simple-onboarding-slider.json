{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "simple-onboarding-slider",
  "type": "registry:block",
  "title": "Simple Onboarding Slider",
  "description": "A sleek and interactive onboarding slider for React Native apps, designed to guide users through key features with smooth transitions and engaging visuals",
  "registryDependencies": [
    "@react-native-scenes/utils",
    "@react-native-scenes/button",
    "@react-native-scenes/text"
  ],
  "files": [
    {
      "path": "src/scenes/simple-onboarding-slider.tsx",
      "content": "import {\n  cloneElement,\n  createContext,\n  isValidElement,\n  type ReactNode,\n  type RefObject,\n  useCallback,\n  useContext,\n  useRef,\n} from \"react\";\nimport {\n  Animated,\n  FlatList,\n  type NativeScrollEvent,\n  type NativeSyntheticEvent,\n  Pressable,\n  useWindowDimensions,\n  View,\n  type ViewProps,\n} from \"react-native\";\nimport { Text } from \"@/components/ui/text\";\nimport { cn } from \"@/lib/utils\";\n\nexport type Step = {\n  id: string;\n  children?: ReactNode;\n} & Record<string, any>;\n\ntype OnboardingContextValue = {\n  scrollX: Animated.Value;\n  currentIndex: number;\n  all: Step[];\n  isLast: boolean;\n  isFirst: boolean;\n  goTo: (index: number) => void;\n  handleNext: () => void;\n  flatListRef: RefObject<FlatList | null>;\n};\n\nconst OnboardingContext = createContext<OnboardingContextValue | undefined>(\n  undefined\n);\n\nconst useOnboarding = () => {\n  const context = useContext(OnboardingContext);\n\n  if (!context) {\n    throw new Error(\n      \"OnboardingSlider components must be used within OnboardingSlider\"\n    );\n  }\n\n  return context;\n};\n\nexport type OnboardingSliderProps = {\n  /**\n   * Array of steps to display. Each step must have an `id` property.\n   */\n  all: Step[];\n  /**\n   * Current step.\n   */\n  current: Step;\n  /**\n   * Whether the current step is the last one.\n   */\n  isLast: boolean;\n  /**\n   * Whether the current step is the first one.\n   */\n  isFirst: boolean;\n  /**\n   * Callback to go to a specific step by its index in the `all` array.\n   * @param index - index of the step to go to.\n   */\n  goTo: (index: number) => void;\n  children: ReactNode;\n};\n\nconst OnboardingSlider = ({\n  current,\n  all,\n  isLast,\n  isFirst,\n  goTo,\n  className,\n  children,\n  ...props\n}: OnboardingSliderProps & ViewProps) => {\n  const scrollX = useRef(new Animated.Value(0)).current;\n  const currentIndex = all.findIndex((step) => step.id === current.id);\n  const flatListRef = useRef<FlatList>(null);\n\n  const handleNext = useCallback(() => {\n    const newIndex = currentIndex + 1;\n    if (newIndex >= all.length) {\n      return;\n    }\n    flatListRef.current?.scrollToIndex({ index: newIndex, animated: true });\n    goTo(newIndex);\n  }, [currentIndex, all.length, goTo]);\n\n  const contextValue: OnboardingContextValue = {\n    scrollX,\n    currentIndex,\n    all,\n    isLast,\n    isFirst,\n    goTo,\n    handleNext,\n    flatListRef,\n  };\n\n  return (\n    <OnboardingContext.Provider value={contextValue}>\n      <View {...props} className={cn(\"flex-1 gap-8\", className)}>\n        {children}\n      </View>\n    </OnboardingContext.Provider>\n  );\n};\n\nconst OnboardingSliderHeader = ({\n  className,\n  children,\n  ...props\n}: ViewProps) => (\n  <View className={cn(\"\", className)} {...props}>\n    {children}\n  </View>\n);\n\nconst OnboardingSliderContent = ({\n  className,\n  children,\n  ...props\n}: ViewProps) => (\n  <View className={cn(\"flex-1\", className)} {...props}>\n    {children}\n  </View>\n);\n\ntype OnboardingSliderItemsProps = {\n  items: Step[];\n} & Omit<ViewProps, \"children\">;\n\nconst OnboardingSliderItems = ({\n  items,\n  className,\n  ...props\n}: OnboardingSliderItemsProps) => {\n  const { scrollX, goTo, flatListRef } = useOnboarding();\n  const { width } = useWindowDimensions();\n\n  const handleScroll = Animated.event(\n    [{ nativeEvent: { contentOffset: { x: scrollX } } }],\n    {\n      useNativeDriver: false,\n    }\n  );\n\n  const handleMomentumScrollEnd = useCallback(\n    (event: NativeSyntheticEvent<NativeScrollEvent>) => {\n      const newIndex = Math.round(event.nativeEvent.contentOffset.x / width);\n      goTo(newIndex);\n    },\n    [width, goTo]\n  );\n\n  const renderItem = useCallback(\n    ({ item }: { item: Step }) => (\n      <View className=\"flex-1 gap-4\" style={{ width }}>\n        <View className=\"flex-1 items-center justify-center\">\n          {item.children}\n        </View>\n        <View className=\"h-48 gap-4 px-8\">\n          <Text className=\"text-left\" variant=\"h1\">\n            {item.title}\n          </Text>\n          <Text className=\"text-left\" variant=\"lead\">\n            {item.description}\n          </Text>\n        </View>\n      </View>\n    ),\n    [width]\n  );\n\n  return (\n    <View className={cn(\"flex-1\", className)} {...props}>\n      <FlatList\n        bounces={false}\n        data={items}\n        decelerationRate=\"fast\"\n        getItemLayout={(_, index) => ({\n          length: width,\n          offset: width * index,\n          index,\n        })}\n        horizontal\n        onMomentumScrollEnd={handleMomentumScrollEnd}\n        onScroll={handleScroll}\n        pagingEnabled\n        ref={flatListRef}\n        renderItem={renderItem}\n        scrollEventThrottle={16}\n        showsHorizontalScrollIndicator={false}\n      />\n    </View>\n  );\n};\n\nconst OnboardingSliderFooter = ({\n  className,\n  children,\n  ...props\n}: ViewProps) => (\n  <View className={cn(\"px-8 pb-4\", className)} {...props}>\n    {children}\n  </View>\n);\n\ntype OnboardingSliderActionProps = {\n  asChild?: boolean;\n  children: ReactNode;\n} & Omit<ViewProps, \"children\">;\n\nconst OnboardingSliderAction = ({\n  asChild,\n  children,\n  className,\n  ...props\n}: OnboardingSliderActionProps) => {\n  const { handleNext } = useOnboarding();\n\n  if (asChild && isValidElement(children)) {\n    return (\n      <View className={cn(\"px-8 pb-4\", className)} {...props}>\n        {cloneElement(children, { onPress: handleNext } as any)}\n      </View>\n    );\n  }\n\n  return (\n    <View className={cn(\"px-8 pb-4\", className)} {...props}>\n      <Pressable onPress={handleNext}>{children}</Pressable>\n    </View>\n  );\n};\n\nconst OnboardingSliderIndicator = () => {\n  const { scrollX, all } = useOnboarding();\n\n  const { width } = useWindowDimensions();\n\n  return (\n    <View className=\"flex-row gap-2 px-8 pt-4\">\n      {new Array(all.length).fill(undefined).map((_, index) => {\n        const fillWidth = scrollX.interpolate({\n          inputRange: [width * (index - 1), width * index],\n          outputRange: [\"0%\", \"100%\"],\n          extrapolate: \"clamp\",\n        });\n\n        return (\n          <View\n            className=\"h-0.5 flex-1 overflow-hidden rounded-full bg-foreground/20\"\n            key={`indicator-${index}`}\n          >\n            <Animated.View\n              className=\"h-full rounded-full bg-foreground\"\n              style={{\n                width: index === 0 ? \"100%\" : fillWidth,\n              }}\n            />\n          </View>\n        );\n      })}\n    </View>\n  );\n};\n\nOnboardingSlider.Header = OnboardingSliderHeader;\nOnboardingSlider.Content = OnboardingSliderContent;\nOnboardingSlider.Items = OnboardingSliderItems;\nOnboardingSlider.Indicator = OnboardingSliderIndicator;\nOnboardingSlider.Footer = OnboardingSliderFooter;\nOnboardingSlider.Action = OnboardingSliderAction;\n\nexport { OnboardingSlider, useOnboarding };\n",
      "type": "registry:block",
      "target": "components/blocks/simple-onboarding-slider.tsx"
    }
  ]
}
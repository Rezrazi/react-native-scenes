{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "onboarding-slider",
  "type": "registry:block",
  "title": "Simple Onboarding Slider",
  "description": "A simple onboarding slider component",
  "dependencies": [
    "react-native-reanimated"
  ],
  "registryDependencies": [
    "@react-native-scenes/utils"
  ],
  "files": [
    {
      "path": "src/components/blocks/onboarding-slider.tsx",
      "content": "import {\n  cloneElement,\n  createContext,\n  isValidElement,\n  type ReactNode,\n  type RefObject,\n  useCallback,\n  useContext,\n  useRef,\n} from \"react\";\nimport {\n  type FlatList,\n  type NativeScrollEvent,\n  type NativeSyntheticEvent,\n  Pressable,\n  Text,\n  useWindowDimensions,\n  View,\n  type ViewProps,\n} from \"react-native\";\nimport Animated, {\n  Extrapolation,\n  interpolate,\n  type SharedValue,\n  useAnimatedScrollHandler,\n  useAnimatedStyle,\n  useSharedValue,\n} from \"react-native-reanimated\";\nimport { cn } from \"@/lib/utils\";\n\nexport type Step<T = any> = {\n  id: string;\n  children?: ReactNode;\n} & Record<string, T>;\n\ntype OnboardingSliderContext = {\n  scrollX: SharedValue<number>;\n  currentIndex: number;\n  all: Step[];\n  isLast: boolean;\n  isFirst: boolean;\n  goTo: (index: number) => void;\n  handleNext: () => void;\n  flatListRef: RefObject<FlatList | null>;\n};\n\nconst OnboardingContext = createContext<OnboardingSliderContext | undefined>(undefined);\n\nconst useOnboardingSlider = () => {\n  const context = useContext(OnboardingContext);\n\n  if (!context) {\n    throw new Error(\"OnboardingSlider components must be used within OnboardingSlider\");\n  }\n\n  return context;\n};\n\nexport type OnboardingSliderProps = {\n  /**\n   * Array of steps to display. Each step must have an `id` property.\n   */\n  all: Step[];\n  /**\n   * Current step.\n   */\n  current: Step;\n  /**\n   * Whether the current step is the last one.\n   */\n  isLast: boolean;\n  /**\n   * Whether the current step is the first one.\n   */\n  isFirst: boolean;\n  /**\n   * Callback to go to a specific step by its index in the `all` array.\n   * @param index - index of the step to go to.\n   */\n  goTo: (index: number) => void;\n  /**\n   * Content to display inside the slider.\n   */\n  children: ReactNode;\n};\n\nconst OnboardingSliderRoot = ({\n  current,\n  all,\n  isLast,\n  isFirst,\n  goTo,\n  className,\n  children,\n  ...props\n}: OnboardingSliderProps & ViewProps) => {\n  const scrollX = useSharedValue(0);\n  const currentIndex = all.findIndex((step) => step.id === current.id);\n  const flatListRef = useRef<FlatList>(null);\n\n  const handleNext = useCallback(() => {\n    const newIndex = currentIndex + 1;\n\n    if (newIndex >= all.length) {\n      return;\n    }\n\n    flatListRef.current?.scrollToIndex({ index: newIndex, animated: true });\n\n    goTo(newIndex);\n  }, [currentIndex, all.length, goTo]);\n\n  const value: OnboardingSliderContext = {\n    scrollX,\n    currentIndex,\n    all,\n    isLast,\n    isFirst,\n    goTo,\n    handleNext,\n    flatListRef,\n  };\n\n  return (\n    <OnboardingContext.Provider value={value}>\n      <View {...props} className={cn(\"flex-1 gap-8\", className)}>\n        {children}\n      </View>\n    </OnboardingContext.Provider>\n  );\n};\n\nconst OnboardingSliderHeader = ({ className, children, ...props }: ViewProps) => (\n  <View className={cn(\"\", className)} {...props}>\n    {children}\n  </View>\n);\n\nconst OnboardingSliderContent = ({ className, children, ...props }: ViewProps) => (\n  <View className={cn(\"flex-1\", className)} {...props}>\n    {children}\n  </View>\n);\n\ntype OnboardingSliderItemsProps = {\n  items: Step[];\n} & Omit<ViewProps, \"children\">;\n\nconst OnboardingSliderItems = ({ items, className, ...props }: OnboardingSliderItemsProps) => {\n  const { scrollX, goTo, flatListRef } = useOnboardingSlider();\n  const { width } = useWindowDimensions();\n\n  const scrollHandler = useAnimatedScrollHandler((event) => {\n    scrollX.value = event.contentOffset.x;\n  });\n\n  const handleMomentumScrollEnd = useCallback(\n    (event: NativeSyntheticEvent<NativeScrollEvent>) => {\n      const newIndex = Math.round(event.nativeEvent.contentOffset.x / width);\n      goTo(newIndex);\n    },\n    [width, goTo]\n  );\n\n  const renderItem = useCallback(\n    ({ item }: { item: Step }) => (\n      <View className=\"flex-1 gap-4\" style={{ width }}>\n        <View className=\"flex-1 items-center justify-center\">{item.children}</View>\n        <View className=\"h-48 gap-4 px-8\">\n          <Text className=\"text-left font-extrabold text-4xl text-foreground tracking-tight\">{item.title}</Text>\n          <Text className=\"text-left text-muted text-xl\">{item.description}</Text>\n        </View>\n      </View>\n    ),\n    [width]\n  );\n\n  return (\n    <View className={cn(\"flex-1\", className)} {...props}>\n      <Animated.FlatList\n        bounces={false}\n        data={items}\n        decelerationRate=\"fast\"\n        getItemLayout={(_, index) => ({\n          length: width,\n          offset: width * index,\n          index,\n        })}\n        horizontal\n        onMomentumScrollEnd={handleMomentumScrollEnd}\n        onScroll={scrollHandler}\n        pagingEnabled\n        ref={flatListRef}\n        renderItem={renderItem}\n        scrollEventThrottle={16}\n        showsHorizontalScrollIndicator={false}\n      />\n    </View>\n  );\n};\n\nconst OnboardingSliderFooter = ({ className, children, ...props }: ViewProps) => (\n  <View className={cn(\"px-8 pb-4\", className)} {...props}>\n    {children}\n  </View>\n);\n\ntype OnboardingSliderActionProps = {\n  asChild?: boolean;\n  children: ReactNode;\n} & Omit<ViewProps, \"children\">;\n\nconst OnboardingSliderAction = ({ asChild, children, className, ...props }: OnboardingSliderActionProps) => {\n  const { handleNext } = useOnboardingSlider();\n\n  if (asChild && isValidElement(children)) {\n    return (\n      <View className={cn(\"px-8 pb-4\", className)} {...props}>\n        {cloneElement(children, { onPress: handleNext } as any)}\n      </View>\n    );\n  }\n\n  return (\n    <View className={cn(\"px-8 pb-4\", className)} {...props}>\n      <Pressable onPress={handleNext}>{children}</Pressable>\n    </View>\n  );\n};\n\ntype IndicatorProps = {\n  index: number;\n  scrollX: SharedValue<number>;\n  width: number;\n};\n\nconst Indicator = ({ index, scrollX, width }: IndicatorProps) => {\n  const animatedStyle = useAnimatedStyle(() => {\n    const fillWidth = interpolate(scrollX.value, [width * (index - 1), width * index], [0, 100], Extrapolation.CLAMP);\n\n    return {\n      width: index === 0 ? \"100%\" : `${fillWidth}%`,\n    };\n  });\n\n  return (\n    <View className=\"h-1 flex-1 overflow-hidden rounded-full bg-foreground/25\">\n      <Animated.View className=\"h-full rounded-full bg-accent\" style={animatedStyle} />\n    </View>\n  );\n};\n\nconst OnboardingSliderIndicator = () => {\n  const { scrollX, all } = useOnboardingSlider();\n  const { width } = useWindowDimensions();\n\n  return (\n    <View className=\"flex-row gap-2 px-8 pt-4\">\n      {all.map((_, index) => (\n        <Indicator index={index} key={`indicator-${index}`} scrollX={scrollX} width={width} />\n      ))}\n    </View>\n  );\n};\n\nexport const OnboardingSlider = Object.assign(OnboardingSliderRoot, {\n  Header: OnboardingSliderHeader,\n  Content: OnboardingSliderContent,\n  Items: OnboardingSliderItems,\n  Indicator: OnboardingSliderIndicator,\n  Footer: OnboardingSliderFooter,\n  Action: OnboardingSliderAction,\n});\n",
      "type": "registry:block",
      "target": "components/blocks/onboarding-slider.tsx"
    }
  ]
}